(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{52:function(e,t,a){e.exports=a(95)},89:function(e,t){},94:function(e,t,a){},95:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(49),o=a.n(c),s=a(19),l=a(2),i=a(7),m=function(e,t){switch(t.type){case"ADD_USER":return{online:t.online,username:t.username,room:t.room};case"LOGOUT_USER":return t.logout;case"SAVING_USERS":return t.data;default:return e}},u=Object(n.createContext)(),d=function(e){var t=Object(n.useReducer)(m,{}),a=Object(i.a)(t,2),c=a[0],o=a[1];return console.log(c),Object(n.useEffect)((function(){var e=JSON.parse(sessionStorage.getItem("users"));e&&o({type:"SAVING_USERS",data:e})}),[]),Object(n.useEffect)((function(){sessionStorage.setItem("users",JSON.stringify(c))}),[c]),r.a.createElement(u.Provider,{value:[c,o]},e.children)},f=function(e){var t=Object(n.useContext)(u),a=Object(i.a)(t,2),c=(a[0],a[1]),o=Object(n.useState)(""),s=Object(i.a)(o,2),m=s[0],d=s[1],f=Object(n.useState)(""),E=Object(i.a)(f,2),g=E[0],p=E[1],v=Object(l.f)();return r.a.createElement("div",{className:"container-join"},r.a.createElement("div",{className:"container-form"},r.a.createElement("h1",null,"Join"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),m&&g&&(c({type:"ADD_USER",online:!0,username:m.trim(),room:g.trim()}),v.push("/chat"))},className:"join"},r.a.createElement("div",null,r.a.createElement("input",{type:"text",className:"input-join",value:m||"",onChange:function(e){return d(e.target.value)},placeholder:"username",required:!0,autoComplete:"off"}),r.a.createElement("br",null),r.a.createElement("input",{type:"text",className:"input-join",value:g||"",onChange:function(e){return p(e.target.value)},placeholder:"room",required:!0,autoComplete:"off"}),r.a.createElement("br",null)),r.a.createElement("div",null,r.a.createElement("button",{className:"join-button"},"Join Chat")))))},E=a(51),g=a.n(E),p=a(33),v=function(e,t){switch(t.type){case"ADD_MESSAGE":return[].concat(Object(p.a)(e),[{id:t.id,username:t.username,message:t.text,createdAt:t.createdAt}]);case"ADD_LOCATION":return[].concat(Object(p.a)(e),[{id:t.id,username:t.username,position:t.url,createdAt:t.createdAt}]);default:return e}},h=function(e){var t=JSON.parse(sessionStorage.getItem("users")).username;return r.a.createElement("div",{className:e.text.username===t?"profile-message":"other-message"},r.a.createElement("div",{className:"container-message"},r.a.createElement("h3",{className:"msg-username"},e.text.username),e.text.message?r.a.createElement("h3",{className:"msg-message"},e.text.message):r.a.createElement("a",{href:e.text.position,target:"_blank",className:"msg-position"},"Position"),r.a.createElement("h4",{className:"msg-time"},e.text.createdAt)))},b=function(e,t){switch(t.type){case"ADD_LIST":return t.user;default:return e}},N=a(12),O=a(13),S=function(e){return r.a.createElement("div",null,r.a.createElement("div",{className:"container-user"},r.a.createElement("h3",{className:"single-user"},e.text.username," ",r.a.createElement(N.a,{icon:O.b,className:!0===e.text.online?"online":"offline"}))))},j=function(){var e=Object(n.useContext)(u),t=Object(i.a)(e,2),a=t[0],c=t[1],o=Object(n.useReducer)(b,[]),s=Object(i.a)(o,2),m=s[0],d=s[1],f=a.online,E=a.username,p=a.room,j=Object(n.useState)(!1),x=Object(i.a)(j,2),A=x[0],y=x[1],D=Object(n.useReducer)(v,[]),C=Object(i.a)(D,2),w=C[0],_=C[1],I=Object(l.f)(),k=Object(n.useRef)(),R=document.querySelector("#position");Object(n.useEffect)((function(){return k.current=g()("http://localhost:5000"),k.current.emit("join",{online:f,username:E,room:p},(function(e){e&&(window.alert("cannot log in"),I.push("/"))})),k.current.on("roomData",(function(e){e.room;var t=e.user;d({type:"ADD_LIST",user:t})})),k.current.on("message",(function(e){var t=e.id,a=e.username,n=e.text,r=e.createdAt;a&&(_({type:"ADD_MESSAGE",id:t,username:a,text:n,createdAt:r}),U())})),k.current.on("locationMessages",(function(e){var t=e.id,a=e.username,n=e.url,r=e.createdAt;a&&(_({type:"ADD_LOCATION",id:t,username:a,url:n,createdAt:r}),U())})),function(){k.current.disconnect()}}),[]);var U=function(){var e=document.querySelector(".messages");e.scrollTop=e.scrollHeight};return r.a.createElement("div",{className:"container-chat"},r.a.createElement("div",{className:"container-module"},r.a.createElement("div",{className:"sub-container-module"},r.a.createElement("div",{className:"header-module"},r.a.createElement("h1",{className:"title-mddule"},"Chat"),r.a.createElement(N.a,{icon:O.a,size:"2x",className:"hamburger-module",onClick:function(){return y(!A)}})),r.a.createElement("div",{className:"messages"},w.map((function(e){return r.a.createElement(h,{key:e.id,text:e})}))),r.a.createElement("div",{className:"form-message"},r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var t=document.getElementById("msg").value.trim();k.current.emit("chat-message",t),document.querySelector("#form").reset()},id:"form"},r.a.createElement("div",{className:"form-textarea"},r.a.createElement("textarea",{name:"message",id:"msg",placeholder:"Send message...",autoComplete:"off"})),r.a.createElement("div",null,r.a.createElement("button",{className:"form-button",id:"message"},"Send message"),r.a.createElement("button",{className:"form-button",id:"position",onClick:function(){if(!navigator.geolocation)return{error:"browser is not compatible"};R.setAttribute("disabled","disabled"),navigator.geolocation.getCurrentPosition((function(e){var t="https://google.com/maps?p=".concat(e.coords.latitude,",").concat(e.coords.longitude);k.current.emit("position",t,(function(){R.removeAttribute("disabled"),console.log("position sent")}))}))}},"Send position")))))),r.a.createElement("div",{className:"container-list",id:!0===A?"visible":""},r.a.createElement("div",{className:"header-list"},r.a.createElement("h3",{className:"list-title"},"Chat information"),r.a.createElement("h3",{className:"close-window",onClick:function(){return y(!A)}},"X")),r.a.createElement("div",{className:"list"},r.a.createElement("div",{className:"list-details"},r.a.createElement("h3",{className:"room"},"Room: ",p),r.a.createElement(N.a,{icon:O.c,size:"2x",className:"logoff",onClick:function(){sessionStorage.removeItem("users"),c({type:"LOGOUT_USER",logout:{}}),console.log(a),I.push("/")}})),r.a.createElement("h3",{className:"list-title"},"List User ",r.a.createElement("span",null,"(",m.length,")")),r.a.createElement("div",{className:"list-users"},m.map((function(e){return r.a.createElement(S,{key:e.id,text:e})}))))))};a(94);var x=function(){return r.a.createElement(d,null,r.a.createElement("div",{className:"container"},r.a.createElement(s.a,null,r.a.createElement(l.c,null,r.a.createElement(l.a,{path:"/",exact:!0,component:f}),r.a.createElement(l.a,{path:"/chat",exact:!0,component:j})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(x,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[52,1,2]]]);
//# sourceMappingURL=main.66fd7a4a.chunk.js.map